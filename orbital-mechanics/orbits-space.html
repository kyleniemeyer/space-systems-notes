
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Orbits in space &#8212; Space Systems Engineering notes</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"vector": ["\\vec{#1}", 1], "uvec": ["\\hat{#1}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Orbit transfers" href="orbit-transfers.html" />
    <link rel="prev" title="Two-body problems" href="two-body-problems.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Space Systems Engineering notes</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Space Systems Engineering Notes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../solving-tips.html">
   Problem-solving tips
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Orbital mechanics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="conic-sections.html">
   Introduction to orbital mechanics: conic sections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="two-body-problems.html">
   Two-body problems
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Orbits in space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbit-transfers.html">
   Orbit transfers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rendezvous.html">
   Rendezvous
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbit-perturbations.html">
   Orbit Perturbations
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Launch phase
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../launch-phase/propulsion.html">
   Propulsion
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/orbital-mechanics/orbits-space.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/space-systems-notes"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/space-systems-notes/issues/new?title=Issue%20on%20page%20%2Forbital-mechanics/orbits-space.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/space-systems-notes/edit/main/orbital-mechanics/orbits-space.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/space-systems-notes/main?urlpath=tree/orbital-mechanics/orbits-space.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geocentric-equatorial-frame">
   Geocentric equatorial frame
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orbital-elements">
   Orbital elements
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-line-element-sets">
     Two-line element sets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-orbital-elements-from-state-vectors">
     Calculating orbital elements from state vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-state-vectors-from-orbital-elements">
     Calculating state vectors from orbital elements
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gibbs-problem">
   Gibbs problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lambert-s-problem">
   Lambert’s problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#topocentric-frame">
   Topocentric frame
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="orbits-in-space">
<h1>Orbits in space<a class="headerlink" href="#orbits-in-space" title="Permalink to this headline">¶</a></h1>
<p>Now that we know how to describe orbits in the perifocal frame, we need will look at how to move from this frame of reference to a more-general location in space.</p>
<p>This module will cover:</p>
<ul class="simple">
<li><p>Geocentric equatorial frame</p></li>
<li><p>Orbital elements</p></li>
<li><p>Gibbs problem</p></li>
<li><p>Gauss problem/Lambert theorem</p></li>
<li><p>Topocentric frame</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="geocentric-equatorial-frame">
<h2>Geocentric equatorial frame<a class="headerlink" href="#geocentric-equatorial-frame" title="Permalink to this headline">¶</a></h2>
<p>In the geocentric equatorial frame, the Earth lies at the center and spins,
where the <span class="math notranslate nohighlight">\(X-Y\)</span> plane aligns with the equatorial plane of the planet and
the planet’s axis of rotation points in the <span class="math notranslate nohighlight">\(Z\)</span> direction of the frame.</p>
<p>Note that this frame does not align with the plane of the ecliptic (the solar plane),
since the Earth’s axis is tilted 23.44°.</p>
<div class="myclass figure align-default" id="fig-gef">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/geocentric_equatorial.png"><img alt="Depiction of geocentric equatorial frame" class="bg-white mb-1" src="../_images/geocentric_equatorial.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Diagram of geocentric equatorial frame.
Original source by <a class="reference external" href="https://en.wikipedia.org/wiki/File:Ra_and_dec_rectangular.png">Tfr000</a>,
shared under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">CC BY-SA</a></span><a class="headerlink" href="#fig-gef" title="Permalink to this image">¶</a></p>
</div>
<p>The <span class="math notranslate nohighlight">\(X\)</span> axis of the geocentric equatorial frame always points in the same direction,
towards the vernal equinox. This direction is also referred to as the first point
in Aries, or with ♈, since this pointed to the constellation Aries back
when the Greeks came up with the idea. However, due to the precession of the Earth’s tilt,
the direction changes over time, and it now points towards Pisces. In the year 2600,
the vernal equinox will point towards Aquarius.</p>
<p>Due to this precession, for precise orbital determinations we need to specify the
direction of <span class="math notranslate nohighlight">\(X\)</span> via the appropriate 50-year <strong>epoch</strong>. We are currently in the
2000 epoch, but in 2025 we will pass into the 2050 epoch.</p>
<p>For an object in space, we can specify its position in the geocentric equatorial
frame via its distance from the center (<span class="math notranslate nohighlight">\(r\)</span>), the angle away from the <span class="math notranslate nohighlight">\(X\)</span> direction
in the equatorial plane is the right ascension (<span class="math notranslate nohighlight">\(\alpha\)</span>), and the angle above
the plane is the declination (<span class="math notranslate nohighlight">\(\delta\)</span>).</p>
</div>
<div class="section" id="orbital-elements">
<h2>Orbital elements<a class="headerlink" href="#orbital-elements" title="Permalink to this headline">¶</a></h2>
<p>In the perifocal frame, we can specify an object in orbit using the eccentricity <span class="math notranslate nohighlight">\(e\)</span>,
the specific angular momentum <span class="math notranslate nohighlight">\(h\)</span>, and the true anomaly <span class="math notranslate nohighlight">\(\theta\)</span>.
To specify the orientation of this plane in the geocentric equatorial frame,
we need three additional quantities.</p>
<div class="myclass figure align-default" id="fig-orbital-elements">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/orbital_elements.svg"><img alt="Diagram with classical orbital elements" class="bg-white mb-1" src="../_images/orbital_elements.svg" width="400px" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Diagram showing the orbital elements.
Note that this uses <span class="math notranslate nohighlight">\(\nu\)</span> for true anomaly, while we usually use <span class="math notranslate nohighlight">\(\theta\)</span> here.
Source: <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Orbit1.svg">Lasunncty</a> at the English Wikipedia / <a class="reference external" href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA</a></span><a class="headerlink" href="#fig-orbital-elements" title="Permalink to this image">¶</a></p>
</div>
<p>The additional three quantities needed are the:</p>
<ul class="simple">
<li><p>right ascension <span class="math notranslate nohighlight">\(\Omega\)</span>, which is the angle between the reference direction <span class="math notranslate nohighlight">\(\vec{X}\)</span>, or ♈, and the direction of the line of the ascending node <span class="math notranslate nohighlight">\(\vec{N}\)</span>;</p></li>
<li><p>inclination <span class="math notranslate nohighlight">\(i\)</span>, the angle of the perifocal frame away from the reference plane; and</p></li>
<li><p>argument of periapse/perigee <span class="math notranslate nohighlight">\(\omega\)</span>, the angle between the line of ascending node and direction of periapse <span class="math notranslate nohighlight">\(\vec{e}\)</span>.</p></li>
</ul>
<p>The orbit is prograde if <span class="math notranslate nohighlight">\(i &lt;\)</span> 90°, and retrograde if <span class="math notranslate nohighlight">\(i &gt;\)</span> 90°.</p>
<p>Now, we have the six <strong>orbital elements</strong> needed to uniquely specify an orbit in a two-body system: <span class="math notranslate nohighlight">\(h, e, \theta, \Omega, i, \omega\)</span>.</p>
<div class="section" id="two-line-element-sets">
<h3>Two-line element sets<a class="headerlink" href="#two-line-element-sets" title="Permalink to this headline">¶</a></h3>
<p>Two-line element (TLE) sets, or “elsets”, are a standard format used
to encode and distribute the oribital elements of an object in space,
along with other important information. These were originally designed
for a 72-column punchcard format, like what FORTRAN 77 used.</p>
<p>Particular column ranges encode specific information and quantities.
Here is an example for the <a class="reference external" href="https://en.wikipedia.org/wiki/NOAA-6">NOAA-6 satellite</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NOAA</span> <span class="mi">6</span>
<span class="mi">1</span> <span class="mi">11416</span><span class="n">U</span> <span class="mi">84123</span>  <span class="n">A</span> <span class="mi">86</span> <span class="mf">50.28438588</span> <span class="mf">0.00000140</span>  <span class="mi">00000</span><span class="o">-</span><span class="mi">0</span>  <span class="mi">67960</span><span class="o">-</span><span class="mi">4</span> <span class="mi">0</span>  <span class="mi">5293</span>
<span class="mi">2</span> <span class="mi">11416</span>  <span class="mf">98.5105</span>  <span class="mf">69.3305</span> <span class="mi">0012788</span>  <span class="mf">63.2828</span> <span class="mf">296.9658</span> <span class="mf">14.24899292346978</span>
</pre></div>
</div>
<p>Line 0 contains the satellite name (up to 24 characters).
On line 1: by column range:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>01</p></td>
<td><p>line number (1)</p></td>
</tr>
<tr class="row-odd"><td><p>03-07</p></td>
<td><p>satellite number designated by USSPACECOM (11416)</p></td>
</tr>
<tr class="row-even"><td><p>08</p></td>
<td><p>classification (<code class="docutils literal notranslate"><span class="pre">U</span></code> means unclassified)</p></td>
</tr>
<tr class="row-odd"><td><p>10-11</p></td>
<td><p>international designator, launch year (<code class="docutils literal notranslate"><span class="pre">84</span></code> means 1984)</p></td>
</tr>
<tr class="row-even"><td><p>12-14</p></td>
<td><p>international designator, launch number (<code class="docutils literal notranslate"><span class="pre">123</span></code> means 124th launch)</p></td>
</tr>
<tr class="row-odd"><td><p>15-17</p></td>
<td><p>international designator, piece (<code class="docutils literal notranslate"><span class="pre">A</span></code> means first object)</p></td>
</tr>
<tr class="row-even"><td><p>19-20</p></td>
<td><p>Epoch year (<code class="docutils literal notranslate"><span class="pre">86</span></code> means 1986)</p></td>
</tr>
<tr class="row-odd"><td><p>21-32</p></td>
<td><p>Epoch, Julian day fraction (<code class="docutils literal notranslate"><span class="pre">50.28438588</span></code> converts to 050:06:49:30.94)</p></td>
</tr>
<tr class="row-even"><td><p>34-43</p></td>
<td><p>ballistic coefficient, or 1st time derivative of mean motion (<code class="docutils literal notranslate"><span class="pre">0.00000140</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>45-52</p></td>
<td><p>2nd derivative of mean motion, usually blank (<code class="docutils literal notranslate"><span class="pre">00000-0</span></code> = 0.00000)</p></td>
</tr>
<tr class="row-even"><td><p>54-61</p></td>
<td><p>BSTAR, or drag term (<code class="docutils literal notranslate"><span class="pre">67960-4</span></code> means <code class="docutils literal notranslate"><span class="pre">0.67960e-4</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>63</p></td>
<td><p>ephemeris type (<code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>65-69</p></td>
<td><p>element number and checksum</p></td>
</tr>
</tbody>
</table>
<p>On line 2:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>01</p></td>
<td><p>line number (2)</p></td>
</tr>
<tr class="row-odd"><td><p>03-07</p></td>
<td><p>satellite number designated by USSPACECOM (11416)</p></td>
</tr>
<tr class="row-even"><td><p>09-16</p></td>
<td><p>inclination in degrees (<code class="docutils literal notranslate"><span class="pre">98.5105</span></code> means 98.5105°)</p></td>
</tr>
<tr class="row-odd"><td><p>18-25</p></td>
<td><p>right ascension of the ascending node in degrees (<code class="docutils literal notranslate"><span class="pre">69.3305</span></code> means 69.3305°)</p></td>
</tr>
<tr class="row-even"><td><p>27-33</p></td>
<td><p>eccentricity (<code class="docutils literal notranslate"><span class="pre">0012788</span></code> means 0.0012788)</p></td>
</tr>
<tr class="row-odd"><td><p>35-42</p></td>
<td><p>argument of perigee, in degrees (<code class="docutils literal notranslate"><span class="pre">63.2828</span></code> means 63.2828°)</p></td>
</tr>
<tr class="row-even"><td><p>44-51</p></td>
<td><p>mean anomaly, in degrees (<code class="docutils literal notranslate"><span class="pre">296.9658</span></code> means 296.9658°)</p></td>
</tr>
<tr class="row-odd"><td><p>53-63</p></td>
<td><p>mean motion, orbits per day (<code class="docutils literal notranslate"><span class="pre">14.24899292</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>64-68</p></td>
<td><p>revolution number at epoch, in orbits (<code class="docutils literal notranslate"><span class="pre">34697</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p>69</p></td>
<td><p>checksum</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="calculating-orbital-elements-from-state-vectors">
<h3>Calculating orbital elements from state vectors<a class="headerlink" href="#calculating-orbital-elements-from-state-vectors" title="Permalink to this headline">¶</a></h3>
<p>Given the state vectors <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>, a typical problem is to
calculate the six orbital elements.</p>
<p>First, calculate the magnitudes of relevant vectors:</p>
<div class="math notranslate nohighlight">
\[
r = | \vec{r} | \quad v = |\vec{v}| \quad v_r = \frac{\vec{r} \cdot \vec{v}}{r}
\]</div>
<p>Then, calculate each of the orbital elements:</p>
<ol>
<li><p>Specific angular momentum:</p>
<div class="math notranslate nohighlight">
\[
   \vec{h} = \vec{r} \times \vec{v} \quad h = |\vec{h}|
   \]</div>
</li>
<li><p>Inclination:</p>
<div class="math notranslate nohighlight">
\[
   i = \cos^{-1} \left( \frac{h_z}{h} \right)
   \]</div>
</li>
<li><p>Right ascension of the ascending node:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{N} &amp;= \vec{K} \times \vec{h} \\
   N &amp;= \left| \vec{N} \right| \\
   \Omega &amp;= \begin{cases}
     \cos^{-1} \left( \frac{N_x}{N} \right) \quad \text{if } N_Y \geq 0 \;, \\
     360° - \cos^{-1} \left( \frac{N_x}{N} \right) \quad \text{if } N_Y &lt; 0 \;, \\
   \end{cases}
   \end{align}
   \end{split}\]</div>
</li>
<li><p>Eccentricity:</p>
<div class="math notranslate nohighlight">
\[
   \vec{e} = \frac{1}{\mu} \left[ \left( v^2 - \frac{\mu}{r} \right) \vec{r} - r v_r \vec{v} \right] \quad e = | \vec{e} |
   \]</div>
</li>
<li><p>Argument of perigee (i.e., argument of periapse):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \omega = \begin{cases}
     \cos^{-1} \left( \frac{\vec{N} \cdot \vec{e}}{N e} \right) \quad \text{if } e_Z \geq 0 \;, \\
     360° - \cos^{-1} \left( \frac{\vec{N} \cdot \vec{e}}{N e} \right) \quad \text{if } e_Z &lt; 0 \;, \\
   \end{cases}
   \end{split}\]</div>
</li>
<li><p>True anomaly:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \theta = \begin{cases}
   \cos^{-1} \left( \frac{\vec{e} \cdot \vec{r}}{e r} \right) \quad \text{if } v_r \geq 0 \;, \\
     360° - \cos^{-1} \left( \frac{\vec{e} \cdot \vec{r}}{e r} \right) \quad \text{if } v_r &lt; 0 \;, \\
   \end{cases}
   \end{split}\]</div>
</li>
</ol>
</div>
<div class="section" id="calculating-state-vectors-from-orbital-elements">
<h3>Calculating state vectors from orbital elements<a class="headerlink" href="#calculating-state-vectors-from-orbital-elements" title="Permalink to this headline">¶</a></h3>
<p>The opposite from above is calculating the position and velocity state vectors
from the six orbital elements. We can do this by using <span class="math notranslate nohighlight">\(h, e, \theta\)</span> to determine
<span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> in the perifocal frame, and then rotating into the
geocentric equatorial frame of reference (<span class="math notranslate nohighlight">\(\vec{R}\)</span> and <span class="math notranslate nohighlight">\(\vec{V}\)</span>).</p>
<p>We can find the overall transformation by combining three rotation matrices:</p>
<ol>
<li><p>Yaw about the <span class="math notranslate nohighlight">\(Z\)</span> axis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   R_3 \left( \Omega \right) = \begin{bmatrix}
     \cos \Omega &amp; \sin \Omega &amp; 0 \\
     -\sin \Omega &amp; \cos \Omega &amp; 0 \\
     0 &amp; 0 &amp; 1 \end{bmatrix}
   \end{split}\]</div>
</li>
<li><p>Pitch about the <span class="math notranslate nohighlight">\(X_P^{\prime}\)</span> axis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   R_1 \left( i \right) = \begin{bmatrix}
     1 &amp; 0 &amp; 0 \\
     0 &amp; \cos i &amp; \sin i \\
     0 &amp; -\sin i &amp; \cos i \end{bmatrix}
   \end{split}\]</div>
</li>
<li><p>Roll about the <span class="math notranslate nohighlight">\(Z_P^{\prime}\)</span> axis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   R_3 \left( \omega \right) = \begin{bmatrix}
     \cos \omega &amp; \sin \omega &amp; 0 \\
     -\sin \omega &amp; \cos \omega &amp; 0 \\
     0 &amp; 0 &amp; 1 \end{bmatrix}
   \end{split}\]</div>
</li>
<li><p>Calculate the total transformation matrix:</p>
<div class="math notranslate nohighlight">
\[
   \left[ Q_{Xx} \right] = R_3 \left( \omega \right) R_1 (i) R_3 \left( \Omega \right) \;,
   \]</div>
<p>which involves matrix multiplications.</p>
</li>
<li><p>Calculate the new position and velocity vectors in the geocentric equatorial frame:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{R} &amp;= \left[ Q_{Xx} \right]^{\top} \vec{r} \\
   \vec{V} &amp;= \left[ Q_{Xx} \right]^{\top} \vec{v} \;,
   \end{align}
   \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> are the state vectors in the perifocal frame:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{r} &amp;= \frac{h^2 / \mu}{1 + e \cos \theta} \begin{bmatrix} \cos \theta &amp; \sin \theta &amp; 0 \end{bmatrix} \\
   \vec{v} &amp;= \frac{\mu}{h} \begin{bmatrix} -\sin \theta &amp; e + \cos \theta &amp; 0 \end{bmatrix}
   \end{align}
   \end{split}\]</div>
</li>
</ol>
</div>
</div>
<div class="section" id="gibbs-problem">
<h2>Gibbs problem<a class="headerlink" href="#gibbs-problem" title="Permalink to this headline">¶</a></h2>
<p>One possible situation is determining the orbit from three sightings / position vectors;
this is the Gibbs problem.</p>
<p><strong>The problem:</strong> Given <span class="math notranslate nohighlight">\(\vec{R}_1, \vec{R}_2, \vec{R}_3\)</span>, find the six orbital elements
<span class="math notranslate nohighlight">\(h, e, \theta, \omega, \Omega, i\)</span>.</p>
<div class="myclass figure align-default" id="fig-gibbs">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/gibbs-problem.png"><img alt="Diagram showing Gibbs problem" class="bg-white mb-1" src="../_images/gibbs-problem.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">Diagram showing Gibbs problem.</span><a class="headerlink" href="#fig-gibbs" title="Permalink to this image">¶</a></p>
</div>
<p>Note that the three position vectors must lie in the same plane, otherwise a stable
two-body orbit is not possible.</p>
<p>The goal here is to calculate the velocity vector at location 1, and then with <span class="math notranslate nohighlight">\(\vec{R}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{V}_1\)</span>
the orbital elements can be found using the steps given above:</p>
<div class="math notranslate nohighlight">
\[
\vec{V}_1 = \sqrt{ \frac{\mu}{N D} } \left( \frac{\vec{D} \times \vec{R}_1}{r_1} + \vec{S} \right) \;,
\]</div>
<p>where the magnitudes of the position vectors are <span class="math notranslate nohighlight">\(r_1 = \left| \vec{R}_1 \right|\)</span>, <span class="math notranslate nohighlight">\(r_2 = \left| \vec{R}_2 \right|\)</span>,
<span class="math notranslate nohighlight">\(r_3 = \left| \vec{R}_3 \right|\)</span>, and the other vectors are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{N} &amp;= r_1 \left( \vec{R}_2 \times \vec{R}_3 \right) + r_2 \left( \vec{R}_3 \times \vec{R}_1 \right) + r_3 \left( \vec{R}_1 \times \vec{R}_2 \right) \\
\vec{D} &amp;= \vec{R}_2 \times \vec{R}_3 + \vec{R}_3 \times \vec{R}_1 + \vec{R}_1 \times \vec{R}_2 \\
\vec{S} &amp;= \vec{R}_1 (r_2 - r_3) + \vec{R}_2 (r_3 - r_1) + \vec{R}_3 (r_1 - r_2) \;,
\end{align}
\end{split}\]</div>
<p>and the magnitudes are <span class="math notranslate nohighlight">\(N = \left| \vec{N} \right|\)</span> and <span class="math notranslate nohighlight">\(D = \left| \vec{D} \right|\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You need to check that <span class="math notranslate nohighlight">\(\vec{D} \neq 0\)</span>, <span class="math notranslate nohighlight">\(\vec{N} \neq 0\)</span>, and that <span class="math notranslate nohighlight">\(\vec{D} \cdot \vec{N} \geq 0\)</span>.</p>
</div>
</div>
<div class="section" id="lambert-s-problem">
<h2>Lambert’s problem<a class="headerlink" href="#lambert-s-problem" title="Permalink to this headline">¶</a></h2>
<p>Another fundamental problem is <strong>Lambert’s problem</strong>, which is finding the orbit that connects two points in space for a given transfer time.</p>
<div class="myclass figure align-default" id="fig-lambert">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/lambert-problem.png"><img alt="Diagram showing Lambert problem" class="bg-white mb-1" src="../_images/lambert-problem.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">Diagram showing Lambert’s problem of orbital transfer between two points.</span><a class="headerlink" href="#fig-lambert" title="Permalink to this image">¶</a></p>
</div>
<p><strong>Problem:</strong> Given <span class="math notranslate nohighlight">\(\vec{R}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{R}_2\)</span>, and <span class="math notranslate nohighlight">\(\Delta t\)</span>, find the six orbital elements.</p>
<p>Solution steps:</p>
<ol>
<li><p>Calculate the radial position magnitudes: <span class="math notranslate nohighlight">\(r_1 = \left| \vec{R}_1 \right|\)</span> and <span class="math notranslate nohighlight">\(r_2 = \left| \vec{R}_2 \right|\)</span>.</p></li>
<li><p>Calculate the change in true anomaly, depending on if the orbit is prograde or retrograde (assume prograde to start):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \text{if prograde } (i &lt; 90°): \Delta \theta &amp;= 
     \begin{cases}
     \cos^{-1} \left( \frac{\vec{R}_1 \cdot \vec{R}_2}{r_1 r_2} \right) \quad \text{if } \left(\vec{R}_1 \times \vec{R}_2 \right)_Z \geq 0 \\
     360° - \cos^{-1} \left( \frac{\vec{R}_1 \cdot \vec{R}_2}{r_1 r_2} \right) \quad \text{if } \left(\vec{R}_1 \times \vec{R}_2 \right)_Z &lt; 0
     \end{cases} \\
   \text{if retrograde } (i &gt; 90°): \Delta \theta &amp;= 
     \begin{cases}
     \cos^{-1} \left( \frac{\vec{R}_1 \cdot \vec{R}_2}{r_1 r_2} \right) \quad \text{if } \left(\vec{R}_1 \times \vec{R}_2 \right)_Z &lt; 0 \\
     360° - \cos^{-1} \left( \frac{\vec{R}_1 \cdot \vec{R}_2}{r_1 r_2} \right) \quad \text{if } \left(\vec{R}_1 \times \vec{R}_2 \right)_Z \geq 0
     \end{cases} \\
   \end{align}
   \end{split}\]</div>
</li>
<li><p>Calculate the quantity <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[
   A = \sin \Delta \theta \sqrt{ \frac{r_1 r_2}{1 - \cos \Delta \theta}}
   \]</div>
</li>
<li><p>Iteratively solve for the universal anomaly parameter <span class="math notranslate nohighlight">\(z\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   y(z) &amp;= r_1 + r_2 + A \frac{z S(z) - 1}{\sqrt{C(z)}} \\
   \sqrt{\mu} \, \Delta t &amp;= \left[ \frac{y(z)}{C(z)}\right]^{3/2} S(z) + A \sqrt{y(z)}
   \end{align}
   \end{split}\]</div>
<p>A reasonable initial guess is <span class="math notranslate nohighlight">\(z=1\)</span>. Then, these equations can be used with an equation solver like <code class="docutils literal notranslate"><span class="pre">fzero</span></code>
in Matlab or <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar</span></code> in Python to solve for <span class="math notranslate nohighlight">\(z\)</span>. If <span class="math notranslate nohighlight">\(z &lt; 0\)</span>, the orbit is hyperbolic,
and if <span class="math notranslate nohighlight">\(z &gt; 0\)</span> the solution is elliptic.</p>
</li>
<li><p>Calculate the universal Lagrange coefficients using the value of <span class="math notranslate nohighlight">\(z\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   f &amp;= 1 - \frac{y(z)}{r_1} \\
   g &amp;= A \sqrt{ \frac{y(z)}{\mu} } \\
   \dot{f} &amp;= \frac{\sqrt{\mu}}{r_1 r_2} \sqrt{ \frac{y(z)}{C(z)}} \left[ z S(z) - 1 \right] \\
   \dot{g} &amp;= 1 - \frac{y(z)}{r_2}
   \end{align}
   \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(C(z)\)</span> and <span class="math notranslate nohighlight">\(S(z)\)</span> are the Stumpf functions.</p>
</li>
<li><p>Calculate the velocities at each position:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{V}_1 &amp;= \frac{1}{g} \left( \vec{R}_2 - f \vec{R}_1 \right) \\
   \vec{V}_2 &amp;= \frac{1}{g} \left( \dot{g} \vec{R}_2 - \vec{R}_1 \right) \\
   \end{align}
   \end{split}\]</div>
</li>
<li><p>With either state vector combination (say, <span class="math notranslate nohighlight">\(\vec{R}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{V}_1\)</span>), you can now obtain the orbital elements.</p></li>
</ol>
<p>If you find that the orbit is actually retrograde (<span class="math notranslate nohighlight">\(i &gt; 90°\)</span>), then repeat the process starting at step 2 using the appropriate equation.</p>
</div>
<div class="section" id="topocentric-frame">
<h2>Topocentric frame<a class="headerlink" href="#topocentric-frame" title="Permalink to this headline">¶</a></h2>
<p>The <strong>topocentric frame</strong> describes the location of an orbiting object from a viewing location on the Earth’s surface, based on instantaneous geodetic latitude (<span class="math notranslate nohighlight">\(\phi\)</span>) and longitude (<span class="math notranslate nohighlight">\(\theta\)</span>).
This will be an instantaneous relationship, since latitude and longitude are fixed but on the rotating surface of the Earth.</p>
<p><strong>The problem:</strong> find the range and elevation from a viewing point on the surface, given the instantaneous position vector of the orbiting object in the geocentric equatorial frame <span class="math notranslate nohighlight">\(\vec{R}_{X}\)</span>,
the geodetic latitude <span class="math notranslate nohighlight">\(\phi\)</span>, and the geodetic longitude <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>Subscript meanings:</p>
<ul class="simple">
<li><p>capital <span class="math notranslate nohighlight">\(X\)</span>: vector in the geocentric equatorial frame</p></li>
<li><p>lowercase <span class="math notranslate nohighlight">\(x\)</span>: vector in the topocentric frame</p></li>
</ul>
<p>The solution is to find the relative position vector in the geocentric equatorial frame,
then rotate that into the local topocentric frame:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{\rho}_X &amp;= \vec{R}_X - \vec{R}_{\text{site}} \\
\vec{\rho}_x &amp;= [Q_{Xx}] \vec{\rho}_X \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{R}_{\text{site}}\)</span> is the position vector from the Earth’s center
(i.e., the origin of the geocentric equatorial frame):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{R}_{\text{site}} = \left[ \frac{\bar{R}_e}{\sqrt{1 - (2f - f^2) \sin^2 \phi}} + H \right] \cos \phi
\left\{ \cos \theta \, \vec{I} + \sin \theta \, \vec{J} \right\} + \\ 
\left[ \frac{\bar{R}_e (1 - f)^2}{\sqrt{1 - (2f - f^2) \sin^2 \phi}} + H \right] \sin \phi \, \vec{K} \;,
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{R}_e\)</span> = 6378 km is the average radius of the Earth,
<span class="math notranslate nohighlight">\(H\)</span> is the altitude/elevation of the observing site, and
<span class="math notranslate nohighlight">\(f = 0.003353\)</span> is the oblatedness of the Earth.
Then, <span class="math notranslate nohighlight">\([Q_{Xx}] = R_1 \left( \phi \right) \cdot R_3 \left( \theta \right)\)</span>
is the rotation matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
R_1 \left( \phi \right) &amp;= \begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; -\sin \phi &amp; \cos \phi \\
0 &amp; \cos \phi  &amp; \sin \phi \end{bmatrix} \\
R_3 \left( \theta \right) &amp;= \begin{bmatrix}
-\sin \theta &amp; \cos \theta &amp; 0 \\
\cos \theta &amp; \sin \theta &amp; 0 \\
0 &amp; 0 &amp; 1 \end{bmatrix} \;.
\end{align}
\end{split}\]</div>
<p>Then, we can find the range with <span class="math notranslate nohighlight">\(\left| \vec{\rho}_x \right|\)</span> and elevation with</p>
<div class="math notranslate nohighlight">
\[
a = \sin^{-1} \left( \hat{\rho}_z \right) \quad \hat{\rho} = \frac{\vec{\rho}_x}{\left| \vec{\rho}_x \right|} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\rho}_z\)</span> is the <span class="math notranslate nohighlight">\(z\)</span>-component of the unit position vector <span class="math notranslate nohighlight">\(\hat{\rho}\)</span>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./orbital-mechanics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="two-body-problems.html" title="previous page">Two-body problems</a>
    <a class='right-next' id="next-link" href="orbit-transfers.html" title="next page">Orbit transfers</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
          <div class="extra_footer">
            <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/space-systems-notes">Space Systems Engineering notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>