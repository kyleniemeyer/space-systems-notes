
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Two-body problems &#8212; Space Systems Engineering notes</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"vector": ["\\vec{#1}", 1], "uvec": ["\\hat{#1}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Orbits in space" href="orbits-space.html" />
    <link rel="prev" title="Introduction to orbital mechanics: conic sections" href="conic-sections.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Space Systems Engineering notes</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Space Systems Engineering Notes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../solving-tips.html">
   Problem-solving tips
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Orbital mechanics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="conic-sections.html">
   Introduction to orbital mechanics: conic sections
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Two-body problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbits-space.html">
   Orbits in space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbit-transfers.html">
   Orbit transfers
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/orbital-mechanics/two-body-problems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/space-systems-notes"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/space-systems-notes/issues/new?title=Issue%20on%20page%20%2Forbital-mechanics/two-body-problems.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/space-systems-notes/edit/main/orbital-mechanics/two-body-problems.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/space-systems-notes/main?urlpath=tree/orbital-mechanics/two-body-problems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-body-problems-in-perifocal-frame">
   Two-body problems in perifocal frame
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagrange-coefficients">
     Lagrange coefficients
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-workflow">
   Example workflow
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kepler-problems">
   Kepler problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-time-of-flight">
     Example: find time of flight
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-find-change-in-true-anomaly">
   Example: find change in true anomaly
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#universal-variable-approach">
   Universal variable approach
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve-equation-of-motion-numerically">
   Solve equation of motion numerically
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary-of-kepler-s-equations">
   Summary of Kepler’s equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#elliptic-orbit">
     Elliptic orbit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hyperbolic-orbit">
     Hyperbolic orbit
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="two-body-problems">
<h1>Two-body problems<a class="headerlink" href="#two-body-problems" title="Permalink to this headline">¶</a></h1>
<p>This module covers solution methods for two-body problems in the <strong>perifocal frame</strong>:
given some information about an orbit, how can we find the new position and velocity
after some change in true anomaly or after some time?</p>
<p>This will cover two-body problem solutions using Lagrange coefficients,
Kepler problems (involving time), the Kepler problem with universal variables,
and solving the orbital equation of motion numerically from initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these lines are only for helping improve the display</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">set_matplotlib_formats</span>
<span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">150</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="two-body-problems-in-perifocal-frame">
<h2>Two-body problems in perifocal frame<a class="headerlink" href="#two-body-problems-in-perifocal-frame" title="Permalink to this headline">¶</a></h2>
<p><strong>The problem:</strong> given the initial position vector <span class="math notranslate nohighlight">\(\vec{r}_0\)</span> and initial velocity vector <span class="math notranslate nohighlight">\(\vec{v}_0\)</span> (the state vectors),
known at some instant in time, find the new state vectors <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> after the true anomaly changes by <span class="math notranslate nohighlight">\(\Delta \theta\)</span>.</p>
<div class="myclass figure align-default" id="fig-twobody">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/two-body-problem.png"><img alt="Two-body problem diagram" class="bg-white mb-1" src="../_images/two-body-problem.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Diagram of two-body problem with state vectors.</span><a class="headerlink" href="#fig-twobody" title="Permalink to this image">¶</a></p>
</div>
<p>Since the state vectors <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> will always remain in the same two-dimensional plane,
they must be able to be expressed as linear combinations of
<span class="math notranslate nohighlight">\(\vec{r}_0\)</span> and <span class="math notranslate nohighlight">\(\vec{v}_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{r} &amp;= f \vec{r}_0 + g \vec{v}_0 \\
\vec{v} &amp;= \dot{f} \vec{r}_0 + \dot{g} \vec{v}_0 \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(f, g, \dot{f}, \dot{g}\)</span> are the <strong>Lagrange coefficients</strong>, which are constant scalars.</p>
<p>Note that by substituting these into the definition of specific angular momentum <span class="math notranslate nohighlight">\(\vec{h}\)</span>,
which must remain constant, we can obtain the <strong>Lagrange identity</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{h} = \vec{r}_0 \times \vec{v}_0 &amp;= \vec{r} \times \vec{v} \\
&amp;= \left( f \vec{r}_0 + g \vec{v}_0 \right) \times \left( \dot{f} \vec{r}_0 + \dot{g} \vec{v}_0 \right) \\
&amp;= f \dot{f} \vec{r}_0 \times \vec{r}_0 + f \dot{g} \vec{r}_0 \times \vec{v}_0 + g \dot{f} \vec{v}_0 \times \vec{r}_0 + g \dot{g} \vec{v}_0 \times \vec{v}_0 \\
&amp;= f \dot{g} \vec{r}_0 \times \vec{v}_0 + g \dot{f} \vec{v}_0 \times \vec{r}_0 \\
&amp;= f \dot{g} \vec{r}_0 \times \vec{v}_0 - g \dot{f} \vec{r}_0 \times \vec{v}_0 \\
\vec{r}_0 \times \vec{v}_0 &amp;= \left( f \dot{g} - g \dot{f} \right) \vec{r}_0 \times \vec{v}_0 \\
\therefore f \dot{g} - g \dot{f} &amp;= 1 \;,
\end{align}
\end{split}\]</div>
<p>which provides a potentially helpful relationship between the coefficients—given three of them, you can easily find the fourth.</p>
<div class="section" id="lagrange-coefficients">
<span id="sec-lagrange"></span><h3>Lagrange coefficients<a class="headerlink" href="#lagrange-coefficients" title="Permalink to this headline">¶</a></h3>
<p>Via a complicated derivation, we can find closed-form expressions for the Lagrange coefficients:</p>
<div class="math notranslate nohighlight" id="equation-lagrange">
<span class="eqno">(3)<a class="headerlink" href="#equation-lagrange" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align}
f &amp;= 1 - \frac{\mu r}{h^2} \left( 1 - \cos \Delta \theta \right) \\
g &amp;= \frac{r r_0}{h} \sin \Delta \theta \\
\dot{f} &amp;= \frac{\mu}{h} \frac{1 - \cos \Delta \theta}{\sin \Delta \theta} \left[ \frac{\mu}{h^2} \left( 1 - \cos \Delta \theta \right) - \frac{1}{r_0} - \frac{1}{r} \right] \\
\dot{g} &amp;= 1 - \frac{\mu r_0}{h^2} \left( 1 - \cos \Delta \theta \right) \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_0 = |\vec{r}_0| = \sqrt{\vec{r}_0 \cdot \vec{r}_0}\)</span> is the magnitude of the initial position vector,
<span class="math notranslate nohighlight">\(v_0 = |\vec{v}_0| = \sqrt{\vec{v}_0 \cdot \vec{v}_0}\)</span> is the magnitude of the initial velocity vector,
<span class="math notranslate nohighlight">\(v_{r0} = \vec{r}_0 \cdot \vec{v}_0 / r_0\)</span> is the radial component of the initial velocity vector (the projection along the apse line),
<span class="math notranslate nohighlight">\(h = |\vec{h}|\)</span> is the magnitude of the specific angular momentum,
and the new radial distance is</p>
<div class="math notranslate nohighlight">
\[
r = \frac{h^2}{\mu} \frac{1}{1 + \left( \frac{h^2}{\mu r_0} - 1 \right) \cos \Delta \theta - \frac{h v_{r0}}{\mu} \sin \Delta \theta} \;.
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While examples may show elliptical orbits, this approach applies regardless of orbit.</p>
</div>
<p>With these equations, we can now solve the problem.</p>
</div>
</div>
<div class="section" id="example-workflow">
<h2>Example workflow<a class="headerlink" href="#example-workflow" title="Permalink to this headline">¶</a></h2>
<p>The workflow for solving a problem follows these steps:</p>
<ol>
<li><p>Calculate the magnitudes and necessary quantities: <span class="math notranslate nohighlight">\(r_0 = |\vec{r}_0|\)</span>, <span class="math notranslate nohighlight">\(v_0 = |\vec{v}_0|\)</span>,
<span class="math notranslate nohighlight">\(\vec{h} = \vec{r} \times \vec{v}\)</span>, <span class="math notranslate nohighlight">\(h = |\vec{h}|\)</span>, and <span class="math notranslate nohighlight">\(v_{r0} = \frac{ \vec{r}_0 \cdot \vec{v}_0 }{ |r_0| }\)</span>.</p></li>
<li><p>An optional step is to determine the initial true anomaly, and from
that the eccentricity of the orbit <span class="math notranslate nohighlight">\(e\)</span> (which would tell us what
kind of orbit this is):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \theta_0 &amp;= \tan^{-1} \left( \frac{r_{0y}}{r_{0x}} \right) \\
   r_0 &amp;= \frac{h^2 / \mu}{1 + e \cos \theta_0 } \\
   \rightarrow e &amp;= \left( \frac{h^2 / \mu}{r_0} - 1 \right) / \cos \theta_0
   \end{align}
   \end{split}\]</div>
</li>
<li><p>Calculate the new radial distance:</p>
<div class="math notranslate nohighlight">
\[
   r = \frac{h^2}{\mu} \frac{1}{1 + \left( \frac{h^2}{\mu r_0} - 1 \right) \cos \Delta \theta - \frac{h v_{r0}}{\mu} \sin \Delta \theta }
   \]</div>
</li>
<li><p>Calculate the Lagrange coefficients <span class="math notranslate nohighlight">\(f, g, \dot{f}, \dot{g}\)</span>, using Equation <a class="reference internal" href="#equation-lagrange">(3)</a>.</p></li>
<li><p>Finally, calculate the new position and velocity vectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{r} &amp;= f \vec{r}_0 + g \vec{v}_0 \\
   \vec{v} &amp;= \dot{f} \vec{r}_0 + \dot{g} \vec{v}_0
   \end{align}
   \end{split}\]</div>
</li>
</ol>
<p>Here’s example code in Matlab and Python for doing these steps:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="a1e0c528-011a-4018-9299-103b4eadbaab" name="32178d7f-a30e-4905-89b0-0cf21ac85317" type="radio">
</input><label class="tabbed-label" for="a1e0c528-011a-4018-9299-103b4eadbaab">
matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="p">=</span> <span class="mf">398.6e3</span><span class="p">;</span> <span class="c">% km^3/s^2</span>
<span class="n">r0</span> <span class="p">=</span> <span class="p">[.</span> <span class="p">.</span> <span class="p">.];</span>
<span class="n">v0</span> <span class="p">=</span> <span class="p">[.</span> <span class="p">.</span> <span class="p">.];</span>
<span class="n">delta_theta</span> <span class="p">=</span> <span class="p">.;</span>

<span class="c">% 1. Calculate magnitudes</span>
<span class="n">r0_mag</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">dot</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">));</span>
<span class="n">v0_mag</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">dot</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">v0</span><span class="p">));</span>

<span class="n">h</span> <span class="p">=</span> <span class="nb">cross</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">);</span>
<span class="n">h_mag</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">dot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">));</span>
<span class="n">v_r0</span> <span class="p">=</span> <span class="nb">dot</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">)</span> <span class="o">/</span> <span class="n">r0_mag</span><span class="p">;</span>

<span class="c">% 2. Get eccentricity</span>
<span class="n">theta_0</span> <span class="p">=</span> <span class="nb">atan</span><span class="p">(</span><span class="n">r0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">r0</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">e</span> <span class="p">=</span> <span class="p">((</span><span class="n">h_mag</span>^<span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="n">r0_mag</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta_0</span><span class="p">);</span>

<span class="c">% 3. Get new distance</span>
<span class="n">r_mag</span> <span class="p">=</span> <span class="p">(</span><span class="n">h_mag</span>^<span class="mi">2</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="n">h_mag</span>^<span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">r0_mag</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">h_mag</span><span class="o">*</span><span class="n">v_r0</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span><span class="p">);</span>

<span class="c">% 4. Get Lagrange coefficients</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">r_mag</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">h_mag</span>^<span class="mi">2</span><span class="p">;</span>
<span class="n">g</span> <span class="p">=</span> <span class="n">r_mag</span> <span class="o">*</span> <span class="n">r0_mag</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_mag</span><span class="p">;</span>
<span class="n">fdot</span> <span class="p">=</span> <span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">h_mag</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span><span class="o">*</span><span class="p">(</span> <span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span><span class="o">/</span><span class="n">h_mag</span>^<span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r0_mag</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r_mag</span><span class="p">))</span> <span class="o">/</span> <span class="nb">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">);</span>
<span class="n">gdot</span> <span class="p">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">r0_mag</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">h_mag</span>^<span class="mi">2</span><span class="p">;</span>

<span class="c">% 5. Calculate new vectors:</span>
<span class="n">r</span> <span class="p">=</span> <span class="n">f</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">v0</span><span class="p">;</span>
<span class="n">v</span> <span class="p">=</span> <span class="n">fdot</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">gdot</span><span class="o">*</span><span class="n">v0</span><span class="p">;</span>
</pre></div>
</div>
</div>
<input id="c904dcf9-def4-463f-a365-2a20a8007630" name="32178d7f-a30e-4905-89b0-0cf21ac85317" type="radio">
</input><label class="tabbed-label" for="c904dcf9-def4-463f-a365-2a20a8007630">
python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">398.6e3</span> <span class="c1"># km^3/s^2</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span> <span class="o">.</span> <span class="o">.</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span> <span class="o">.</span> <span class="o">.</span><span class="p">])</span>
<span class="n">delta_theta</span> <span class="o">=</span> <span class="o">.</span>

<span class="c1"># 1. Calculate magnitudes</span>
<span class="n">r0_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">))</span>
<span class="n">v0_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">v0</span><span class="p">))</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">)</span>
<span class="n">h_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="n">v_r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">)</span> <span class="o">/</span> <span class="n">r0_mag</span>

<span class="c1"># 2. Get eccentricity</span>
<span class="n">theta_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">r0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">r0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="n">r0_mag</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_0</span><span class="p">)</span>

<span class="c1"># 3. Get new distance</span>
<span class="n">r_mag</span> <span class="o">=</span> <span class="p">(</span><span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
    <span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">r0_mag</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">h_mag</span><span class="o">*</span><span class="n">v_r0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span><span class="o">/</span><span class="n">mu</span>
    <span class="p">)</span>

<span class="c1"># 4. Get Lagrange coefficients</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">r_mag</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">r_mag</span> <span class="o">*</span> <span class="n">r0_mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_mag</span>
<span class="n">fdot</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">h_mag</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span><span class="o">*</span><span class="p">(</span>
    <span class="n">mu</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span><span class="o">/</span><span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r0_mag</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r_mag</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">)</span>
<span class="n">gdot</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">r0_mag</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta_theta</span><span class="p">))</span> <span class="o">/</span> <span class="n">h_mag</span><span class="o">^</span><span class="mi">2</span>

<span class="c1"># 5. Calculate new vectors:</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">v0</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">fdot</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">gdot</span><span class="o">*</span><span class="n">v0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="kepler-problems">
<h2>Kepler problems<a class="headerlink" href="#kepler-problems" title="Permalink to this headline">¶</a></h2>
<p>Kepler problems are two-body problems that involve time:
find the time of flight given information about an orbit and a change in true anomaly,
or find the change in true anomaly (and new state vectors) given a time of flight.</p>
<div class="section" id="example-find-time-of-flight">
<h3>Example: find time of flight<a class="headerlink" href="#example-find-time-of-flight" title="Permalink to this headline">¶</a></h3>
<p><strong>The problem:</strong> Given the orbital eccentricity <span class="math notranslate nohighlight">\(e\)</span>, the initial position vector
<span class="math notranslate nohighlight">\(\vec{r} = \vec{r}_p\)</span> (the position starts at perigee), and the change in
true anomaly <span class="math notranslate nohighlight">\(\Delta \theta\)</span>, find the time of flight <span class="math notranslate nohighlight">\(\Delta t\)</span>.
(The solution procedure does not depend on the initial position being at perigee,
this is just to simplify things a bit.)</p>
<div class="myclass figure align-default" id="fig-kepler-time">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/kepler-problem-time.png"><img alt="Kepler problem for time of flight" class="bg-white mb-1" src="../_images/kepler-problem-time.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Diagram of Kepler problem for finding time of flight.</span><a class="headerlink" href="#fig-kepler-time" title="Permalink to this image">¶</a></p>
</div>
<p>This problem requires a different approach. We can relate the transverse/angular
component of velocity to the change in true anomaly:</p>
<div class="math notranslate nohighlight" id="equation-kepler-integral">
<span class="eqno">(4)<a class="headerlink" href="#equation-kepler-integral" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{align}
V_{\theta} = \frac{h}{r} &amp;= r \dot{\theta} = r \frac{d\theta}{dt} \\
r^2 \, d\theta &amp;= h \, dt \\
\text{but } r &amp;= \frac{h^2 / \mu}{1 + e \cos \theta} \\
\rightarrow \left( \frac{h^2 / \mu}{1 + e \cos \theta} \right)^2 d\theta &amp;= h \, dt \\
\int_{\theta_0 = 0}^{\theta = \Delta \theta} \left( \frac{1}{1 + e \cos \theta} \right)^2 d\theta &amp;= \int_0^t \frac{\mu^2}{h^3} dt \\
\end{align}
\end{split}\]</div>
<p>This is the <strong>Kepler integral</strong>, and it has a closed-form solution!
(Fortunately, the bounds of the integral do not matter—just the <span class="math notranslate nohighlight">\(\Delta \theta\)</span>.)</p>
<p>However, depending on the value of eccentricity <span class="math notranslate nohighlight">\(e\)</span>, the solution takes on different forms.
So this approach depends on knowing eccentricity! We will cover a more-general method that
does not require this information soon.</p>
<p>For an elliptic orbit, the solution to the Kepler integral is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{2 \pi}{T} t &amp;= M_e = E - e \sin E \\
\tan \frac{E}{2} &amp;= \sqrt{\frac{1-e}{1+e}} \tan \frac{\Delta \theta}{2} \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the period of an elliptical orbit,
<span class="math notranslate nohighlight">\(E\)</span> is the eccentric anomaly (which <em>must</em> be in radians), and
<span class="math notranslate nohighlight">\(M_e\)</span> is the mean anomaly.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure you use the correct form of the equations based on the value of eccentricity!
And make sure your anomaly values are in <strong>radians</strong>!</p>
</div>
<p>The solution procedure for solving this problem is then:</p>
<ol>
<li><p>Calculate the magnitude of specific angular momentum <span class="math notranslate nohighlight">\(h\)</span> using the known perigee distance:</p>
<div class="math notranslate nohighlight">
\[
   r_p = \frac{h^2 / \mu}{1 + e} \rightarrow h
   \]</div>
</li>
<li><p>Calculate the apogee distance, and then use this to get the semi-major axis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   r_a &amp;= \frac{h^2 / \mu}{1 - e} \\
   a &amp;= \frac{r_p + r_a}{2}
   \end{align}
   \end{split}\]</div>
</li>
<li><p>For an elliptic orbit, calculate the period:</p>
<div class="math notranslate nohighlight">
\[
   T = \frac{2\pi}{\sqrt{\mu}} a^{3/2}
   \]</div>
</li>
<li><p>Calculate the eccentric anomaly <span class="math notranslate nohighlight">\(E\)</span>, and then use this to get <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-find-change-in-true-anomaly">
<h2>Example: find change in true anomaly<a class="headerlink" href="#example-find-change-in-true-anomaly" title="Permalink to this headline">¶</a></h2>
<p><strong>The problem:</strong> now, given the eccentricity <span class="math notranslate nohighlight">\(e\)</span>, initial position vector <span class="math notranslate nohighlight">\(\vec{r}=\vec{r}_p\)</span>,
and the time of flight <span class="math notranslate nohighlight">\(\Delta t\)</span>, find the associated change in true anomaly <span class="math notranslate nohighlight">\(\Delta \theta\)</span>, and then the new state vectors (<span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>).</p>
<p>As we will quickly see, this problem is a bit trickier, but still solveable.</p>
<p>The following solution steps for an <strong>elliptic</strong> orbit, since the equations only apply
for this case, but the procedure will be the same for other orbits:</p>
<ol>
<li><p>Calculate the semi-major axis <span class="math notranslate nohighlight">\(a\)</span> and orbital period <span class="math notranslate nohighlight">\(T\)</span> using the perigee distance.</p></li>
<li><p>Calculate the mean anomaly using the known time of flight:</p>
<div class="math notranslate nohighlight">
\[
   M_e = \frac{2\pi}{T} t
   \]</div>
<p>Next, we need to to find the eccentric anomaly <span class="math notranslate nohighlight">\(E\)</span>, using the <span class="math notranslate nohighlight">\(M_e = E - e \sin E\)</span>,
but this is a transcendental equation with no closed-form solution.
So, we need to use an iterative solution procedure, for example using the
<code class="docutils literal notranslate"><span class="pre">fzero()</span></code> function in Matlab or the <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar()</span></code> function in Python
(which requires <a class="reference external" href="https://www.scipy.org">SciPy</a>).
Either way, we need a good initial guess, otherwise even these robust algorithms
may not converge to the correct solution.</p>
</li>
<li><p>Use the <strong>Prussing estimate</strong> as a reasonable first guess for <span class="math notranslate nohighlight">\(E\)</span>:</p>
<div class="math notranslate nohighlight">
\[
   E_0 = M_e + \frac{e}{2} \;.
   \]</div>
<p>Then, use an equation solver to find <span class="math notranslate nohighlight">\(E\)</span>:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="6af32f00-f89b-43eb-8bb5-9813175b29c3" name="1167cb9f-74c1-4515-89a7-586bd6f4eb88" type="radio">
</input><label class="tabbed-label" for="6af32f00-f89b-43eb-8bb5-9813175b29c3">
matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">E0</span> <span class="p">=</span> <span class="n">M_e</span> <span class="o">+</span> <span class="n">e</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">E</span> <span class="p">=</span> <span class="n">fzero</span><span class="p">(@</span><span class="n">f</span><span class="p">,</span> <span class="n">E0</span><span class="p">);</span>

<span class="n">function</span> <span class="s">zero</span> <span class="p">=</span> <span class="n">f</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
  <span class="n">M_e</span> <span class="p">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T</span><span class="p">;</span>
  <span class="n">zero</span> <span class="p">=</span> <span class="n">M_e</span> <span class="o">-</span> <span class="p">(</span><span class="n">E</span> <span class="o">-</span> <span class="n">e</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">E</span><span class="p">));</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<input id="2653aaca-1ac8-4013-b769-aeda4155f171" name="1167cb9f-74c1-4515-89a7-586bd6f4eb88" type="radio">
</input><label class="tabbed-label" for="2653aaca-1ac8-4013-b769-aeda4155f171">
python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root_scalar</span>

<span class="k">def</span> <span class="nf">eccentric_anomaly</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
    <span class="n">M_e</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T</span>
    <span class="k">return</span> <span class="n">M_e</span> <span class="o">-</span> <span class="p">(</span><span class="n">E</span> <span class="o">-</span> <span class="n">e</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>

<span class="n">E0</span> <span class="o">=</span> <span class="n">M_e</span> <span class="o">+</span> <span class="n">e</span><span class="o">/</span><span class="mi">2</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">eccentric_anomaly</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">E0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><p>Use <span class="math notranslate nohighlight">\(E\)</span> to find the value of the change in true anomaly:</p>
<div class="math notranslate nohighlight">
\[
   \tan \frac{\Delta \theta}{2} = \sqrt{\frac{1+e}{1-e}} \tan \frac{E}{2} \;.
   \]</div>
</li>
<li><p>Then, with <span class="math notranslate nohighlight">\(\Delta \theta\)</span>, you can find the new state vectors by treating this like a two-body problem and using the <a class="reference internal" href="#sec-lagrange"><span class="std std-ref">Lagrange coefficients</span></a>. Since this example starts at perigee, we know the initial position and velocity vectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \vec{r}_0 &amp;= \vec{r}_p = \left[ r_p, 0, 0 \right] \\
   \vec{v}_0 &amp;= \left[ 0, \frac{h}{r_p}, 0 \right]
   \end{align}
   \end{split}\]</div>
</li>
</ol>
</div>
<div class="section" id="universal-variable-approach">
<h2>Universal variable approach<a class="headerlink" href="#universal-variable-approach" title="Permalink to this headline">¶</a></h2>
<p>The above approaches are all limited by the need to know the eccentricity of the orbit,
which in general you would not know. The <strong>universal variable</strong> approach is a more-general
approach that applies consistently regardless of orbital eccentricity.</p>
<p><strong>The problem:</strong> Given initial position vector <span class="math notranslate nohighlight">\(\vec{r}_0\)</span>,
initial velocity vector <span class="math notranslate nohighlight">\(\vec{v}_0\)</span>, and some time of flight <span class="math notranslate nohighlight">\(\Delta t\)</span>,
find the new state vectors <span class="math notranslate nohighlight">\(\vec{r}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>.</p>
<p>This approach is based on the definition of the universal anomaly <span class="math notranslate nohighlight">\(\chi\)</span>, using:</p>
<div class="math notranslate nohighlight">
\[
\dot{\chi} \equiv \frac{\sqrt{\mu}}{r} \;,
\]</div>
<p>known as the Sundmann transformation.</p>
<p>Through a complicated derivation, this leads to the universal variable formulation of Kepler’s equation:</p>
<div class="math notranslate nohighlight">
\[
\sqrt{\mu} \Delta t = \frac{r_0 v_{r0}}{\sqrt{\mu}} \chi^2 C \left( \alpha \chi^2 \right) + (1 - \alpha r_0) \chi^3 S \left( \alpha \chi^2 \right) + r_0 \chi \;,
\]</div>
<p>which is a highly nonlinear transcendental equation, where
<span class="math notranslate nohighlight">\(\alpha = \frac{1}{a} = \frac{2}{r_0} - \frac{v_0^2}{\mu}\)</span>.
But, this is solveable via iterative methods!</p>
<p>However, as above, we need a good first guess to help the solvers converge,
and we also need to define the functions <span class="math notranslate nohighlight">\(C()\)</span> and <span class="math notranslate nohighlight">\(S()\)</span>.</p>
<ol>
<li><p>First, we can get a first guess for <span class="math notranslate nohighlight">\(\chi\)</span> using the <strong>Chobotov approximation</strong>:</p>
<div class="math notranslate nohighlight">
\[
   \chi_0 = \frac{\sqrt{\mu}}{|a|} \Delta t \;.
   \]</div>
</li>
<li><p>Then, we need to define the <strong>Stumpff functions</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   C(z) &amp;= \frac{\cosh \left(\sqrt{-z}\right) - 1}{-z} \\
   S(z) &amp;= \left\lvert \frac{ \sinh \left(\sqrt{-z}\right) - \sqrt{-z}}{ \left(\sqrt{-z}\right)^3 } \right\rvert \;,
   \end{align}
   \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(z = \alpha \chi^2\)</span>. Take care to include the absolute value when evaluating <span class="math notranslate nohighlight">\(S(z)\)</span>, which must be positive.</p>
</li>
<li><p>Then, solve iteratively for <span class="math notranslate nohighlight">\(\chi\)</span>, using (for example) <code class="docutils literal notranslate"><span class="pre">fzero()</span></code> in Matlab or <code class="docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar()</span></code> in Python.</p></li>
<li><p>Once you obtain <span class="math notranslate nohighlight">\(\chi\)</span>, you can solve for the Lagrange coefficients <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> with the <strong>universal Lagrange equations</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   f &amp;= 1 - \frac{\chi^2}{r_0} C \left( \alpha \chi^2 \right) \\
   g &amp;= \Delta t - \frac{1}{\sqrt{\mu}} \chi^3 S \left( \alpha \chi^2 \right) \;.
   \end{align}
   \end{split}\]</div>
<p>Then, calculate the new position vector: <span class="math notranslate nohighlight">\(\vec{r} = f \vec{r}_0 + g \vec{v}_0\)</span>.</p>
</li>
<li><p>Calculate the magnitude of <span class="math notranslate nohighlight">\(\vec{r}\)</span>: <span class="math notranslate nohighlight">\(|\vec{r}|\)</span>.</p></li>
<li><p>Then, we can get <span class="math notranslate nohighlight">\(\dot{f}\)</span> and <span class="math notranslate nohighlight">\(\dot{g}\)</span> to find the velocity vector:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
   \dot{f} &amp;= \frac{\sqrt{\mu}}{r r_0} \left[ \alpha \chi^3 S \left( \alpha \chi^2 \right) - \chi \right] \\
   \dot{g} &amp;= 1 - \frac{\chi^2}{r} C \left( \alpha \chi^2 \right) \\
   \vec{v} &amp;= \dot{f} \vec{r}_0 + \dot{g} \vec{v}_0 \;.
   \end{align}
   \end{split}\]</div>
</li>
</ol>
</div>
<div class="section" id="solve-equation-of-motion-numerically">
<h2>Solve equation of motion numerically<a class="headerlink" href="#solve-equation-of-motion-numerically" title="Permalink to this headline">¶</a></h2>
<p>An alternate strategy for finding the position and velocity of an orbiting body after some time of flight, given the initial position and velocity, is to numerically integrate the orbital equation of motion:</p>
<div class="math notranslate nohighlight">
\[
\vec{ \ddot{r} } + \frac{\mu}{r^3} \vec{r} = 0 \;,
\]</div>
<p>based on initial conditions <span class="math notranslate nohighlight">\(\vec{r}_0\)</span> and <span class="math notranslate nohighlight">\(\vec{v}_0\)</span> defined at an initial time <span class="math notranslate nohighlight">\(t_0\)</span>.
Integrating this forward in time would give us the position as a function of time:
<span class="math notranslate nohighlight">\(x(t)\)</span>, <span class="math notranslate nohighlight">\(y(t)\)</span>, and <span class="math notranslate nohighlight">\(z(t)\)</span>.</p>
<p>If you recall the methods for integrating second-order ordinary differential equations (ODEs),
we can solve this by decomposing it into six first-order ODEs:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
z_1 &amp;= x \rightarrow \dot{z}_1 = z_4 \\
z_2 &amp;= y \rightarrow \dot{z}_2 = z_5 \\
z_3 &amp;= z \rightarrow \dot{z}_3 = z_6 \\
z_4 &amp;= \dot{x} \rightarrow \dot{z}_4 = \ddot{x} = -\frac{\mu}{r^3} z_1 \\
z_5 &amp;= \dot{y} \rightarrow \dot{z}_5 = \ddot{y} = -\frac{\mu}{r^3} z_2 \\
z_6 &amp;= \dot{z} \rightarrow \dot{z}_6 = \ddot{z} = -\frac{\mu}{r^3} z_3 \;,
\end{align}
\end{split}\]</div>
<p>where the radial position magnitude is <span class="math notranslate nohighlight">\(r = \sqrt{z_1^2 + z_2^2 + z_3^2}\)</span>.</p>
<p>We can then integrate using <code class="docutils literal notranslate"><span class="pre">ode45()</span></code> in Matlab, or <code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> in Python/SciPy:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="81200ff6-fdd9-4242-9b81-e379fe0e8c6f" name="767768ee-cd1d-4390-aeec-045dd77572cf" type="radio">
</input><label class="tabbed-label" for="81200ff6-fdd9-4242-9b81-e379fe0e8c6f">
matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">clear</span><span class="p">,</span> <span class="n">clf</span><span class="p">,</span> <span class="n">clc</span><span class="p">;</span>

<span class="n">r0</span> <span class="p">=</span> <span class="p">[.</span> <span class="p">.</span> <span class="p">.];</span>
<span class="n">v0</span> <span class="p">=</span> <span class="p">[.</span> <span class="p">.</span> <span class="p">.];</span>
<span class="n">T</span> <span class="p">=</span> <span class="p">.;</span>

<span class="n">options</span> <span class="p">=</span> <span class="n">odeset</span><span class="p">(</span><span class="s">&#39;RelTol&#39;</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">);</span>

<span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Z</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(@</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">],</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="n">v0</span><span class="p">],</span> <span class="n">options</span><span class="p">);</span>
<span class="n">plot3</span><span class="p">(</span><span class="n">Z</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">Z</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">Z</span><span class="p">(:,</span><span class="mi">3</span><span class="p">));</span>

<span class="c">% function for ODE system</span>
<span class="k">function</span><span class="w"> </span>dzdt <span class="p">=</span><span class="w"> </span><span class="nf">rhs</span><span class="p">(</span>t, z<span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="n">mu</span> <span class="p">=</span> <span class="mf">398.6e3</span><span class="p">;</span> <span class="c">% km^3/s^2</span>
  <span class="n">r</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>^<span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>^<span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>^<span class="mi">2</span><span class="p">);</span>
  <span class="n">dzdt</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="n">z</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">=</span> <span class="n">z</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span>^<span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span>^<span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">dzdt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span>^<span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<input id="4f9eb74d-b227-4c4a-9cfd-51873b7b7741" name="767768ee-cd1d-4390-aeec-045dd77572cf" type="radio">
</input><label class="tabbed-label" for="4f9eb74d-b227-4c4a-9cfd-51873b7b7741">
python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="c1"># 3D orbital motion ODE</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">398.6e3</span> <span class="c1"># km^3/s^2</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">dzdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dzdt</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dzdt</span>
    
<span class="n">r0</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span> <span class="o">.</span> <span class="o">.</span><span class="p">]</span>
<span class="n">v0</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span> <span class="o">.</span> <span class="o">.</span><span class="p">]</span>
<span class="n">T</span> <span class="o">=</span> <span class="o">.</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r0</span> <span class="o">+</span> <span class="n">v0</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mf">2.</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="summary-of-kepler-s-equations">
<h2>Summary of Kepler’s equations<a class="headerlink" href="#summary-of-kepler-s-equations" title="Permalink to this headline">¶</a></h2>
<div class="myclass figure align-default" id="fig-anomaly">
<a class="bg-white mb-1 reference internal image-reference" href="../_images/mean_anomaly.svg"><img alt="Diagram of mean and eccentric anomaly" class="bg-white mb-1" src="../_images/mean_anomaly.svg" width="400px" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Diagram showing the geometric meaning of the mean and eccentric anomaly.
Original sources: <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Anomalies.PNG">PNG by Brews ohare</a>,
<a class="reference external" href="https://commons.wikimedia.org/wiki/File:Mean_Anomaly.svg">SVG by CheCheDaWaff</a>.
Shared under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA</a></span><a class="headerlink" href="#fig-anomaly" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="elliptic-orbit">
<h3>Elliptic orbit<a class="headerlink" href="#elliptic-orbit" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
M_e &amp;= \frac{2 \pi}{T} t = \sqrt{\frac{\mu}{a^3}} t \\
M_e &amp;= E - e \sin E \\
\tan \frac{\theta}{2} &amp;= \sqrt{\frac{1+e}{1-e}} \tan \frac{E}{2} \\
r &amp;= a \left( 1 - e \cos E \right) \\
v^2 &amp;= \mu \left( \frac{2}{r} - \frac{1}{a} \right) \\
r_p &amp;= a (1 - e) \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_e\)</span> is the mean anomaly and <span class="math notranslate nohighlight">\(E\)</span> is the eccentric anomaly.</p>
</div>
<div class="section" id="hyperbolic-orbit">
<h3>Hyperbolic orbit<a class="headerlink" href="#hyperbolic-orbit" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title">Typo in SMAD!</p>
<p>Be careful, there is a typo in the equation relating hyperbolic anomaly and true anomaly
in <em>Space Mission Engineering: The New SMAD</em>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
M_h &amp;= \sqrt{\frac{\mu}{(-a)^3}} \, t = \frac{\mu^2}{h^3} \left( e^2 - 1 \right)^{3/2} t\\
M_h &amp;= e \sinh F - F \\
\tan \frac{\theta}{2} &amp;= \sqrt{\frac{e+1}{e-1}} \tanh \frac{F}{2} \\
r &amp;= a \left( 1 - e \cosh F \right) \\
v^2 &amp;= \mu \left( \frac{2}{r} - \frac{1}{a} \right) \\
r_p &amp;= a (1 - e) \;,
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_h\)</span> is the mean anomaly and <span class="math notranslate nohighlight">\(F\)</span> is the hyperbolic anomaly.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./orbital-mechanics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="conic-sections.html" title="previous page">Introduction to orbital mechanics: conic sections</a>
    <a class='right-next' id="next-link" href="orbits-space.html" title="next page">Orbits in space</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
          <div class="extra_footer">
            <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/space-systems-notes">Space Systems Engineering notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>